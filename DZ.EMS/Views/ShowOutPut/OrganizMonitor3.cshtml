@{
    ViewBag.Title = "OrganizMonitor3";
    Layout = "~/Views/Shared/_Layoutnull.cshtml";
}

<style>
    * {
        margin: 0;
        padding: 0;
        color: #303030;
        font: normal 12px/24px tahoma,verdana,"宋体";
    }

    .innertab {
        border-top: 1px solid #ccc;
        border-left: 1px solid #ccc;
        width: 100%;
    }

    .list_tit td {
        color: #5482B4;
        text-align: center;
        font-weight: bold;
    }

    .innertab td {
        margin: 0;
        padding: 0;
        border-right: 1px solid #ccc;
        border-bottom: 1px solid #ccc;
        text-align: center;
    }
</style>
<script>
    function GetData() {

        var url = "http://114.215.16.58:8081/Pages/Monitor/MonitorHandler.ashx?key=njgro";
        $.ajax({
            url: url,
            dataType: "jsonp",
            jsonpCallback: "callback",
            success: function (obj) {
                $("#timestr").html(obj.time);
                var html = "<table class='innertab'  cellpadding='0' cellspacing='0'>";
                html += $("#hidhtm").html();
                var sumobj = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];
                $.each(obj.data, function (i, item) {
                    var innerhtm = "<tr>";
                    innerhtm += "<td>" + item.Project.ProjectName + "</td>";
                    innerhtm += "<td>" + item.YXZ_FNJ1_YL + "</td>";
                    innerhtm += "<td>" + item.YXZ_FNJ1_JR + "</td>";
                    innerhtm += "<td>" + item.YXZ_FNJ2_YL + "</td>";
                    innerhtm += "<td>" + item.YXZ_FNJ2_JR + "</td>";
                    innerhtm += "<td>" + item.YXZ_FNJ3_YL + "</td>";
                    innerhtm += "<td>" + item.YXZ_FNJ3_JR + "</td>";
                    innerhtm += "<td>" + item.FNJ_TotalYXZ + "</td>";
                    innerhtm += "<td>" + item.YYFP_FNJ1_YL + "</td>";
                    innerhtm += "<td>" + item.YYFP_FNJ1_JR + "</td>";
                    innerhtm += "<td>" + item.YYFP_FNJ2_YL + "</td>";
                    innerhtm += "<td>" + item.YYFP_FNJ2_JR + "</td>";
                    innerhtm += "<td>" + item.YYFP_FNJ3_YL + "</td>";
                    innerhtm += "<td>" + item.YYFP_FNJ3_JR + "</td>";

                    innerhtm += "<td>" + item.WYFP_FNJ1_YL + "</td>";
                    innerhtm += "<td>" + item.WYFP_FNJ1_JR + "</td>";
                    innerhtm += "<td>" + item.WYFP_FNJ2_YL + "</td>";
                    innerhtm += "<td>" + item.WYFP_FNJ2_JR + "</td>";
                    innerhtm += "<td>" + item.WYFP_FNJ3_YL + "</td>";
                    innerhtm += "<td>" + item.WYFP_FNJ3_JR + "</td>";

                    innerhtm += "<td>" + item.DTWC_FNJ1_YL + "</td>";
                    innerhtm += "<td>" + item.DTWC_FNJ1_JR + "</td>";
                    innerhtm += "<td>" + item.DTWC_FNJ2_YL + "</td>";
                    innerhtm += "<td>" + item.DTWC_FNJ2_JR + "</td>";
                    innerhtm += "<td>" + item.DTWC_FNJ3_YL + "</td>";
                    innerhtm += "<td>" + item.DTWC_FNJ3_JR + "</td>";
                    innerhtm += "<td>" + item.CS_YL + "</td>";
                    innerhtm += "<td>" + item.CS_JR + "</td>";
                    innerhtm += "<td>" + item.OnlinePerson+ "</td>";
                    innerhtm += "</tr>"

                    sumobj[0] += item.YXZ_FNJ1_YL;
                    sumobj[1] += item.YXZ_FNJ1_JR;
                    sumobj[2] += item.YXZ_FNJ2_YL;
                    sumobj[3] += item.YXZ_FNJ2_JR;
                    sumobj[4] += item.YXZ_FNJ3_YL;
                    sumobj[5] += item.YXZ_FNJ3_JR;
                    sumobj[6] += item.FNJ_TotalYXZ;
                    sumobj[7] += item.YYFP_FNJ1_YL;
                    sumobj[8] += item.YYFP_FNJ1_JR;
                    sumobj[9] += item.YYFP_FNJ2_YL;
                    sumobj[10] += item.YYFP_FNJ2_JR;
                    sumobj[11] += item.YYFP_FNJ3_JR;
                    sumobj[12] += item.YYFP_FNJ3_YL;
                    sumobj[13] += item.WYFP_FNJ1_YL;
                    sumobj[14] += item.WYFP_FNJ1_YL;
                    sumobj[15] += item.WYFP_FNJ2_YL;
                    sumobj[16] += item.WYFP_FNJ2_JR;
                    sumobj[17] += item.WYFP_FNJ3_YL;
                    sumobj[18] += item.WYFP_FNJ3_JR;

                    sumobj[19] += item.DTWC_FNJ1_YL;
                    sumobj[20] += item.DTWC_FNJ1_YL;
                    sumobj[21] += item.DTWC_FNJ2_YL;
                    sumobj[22] += item.DTWC_FNJ2_YL;

                    sumobj[23] += item.DTWC_FNJ3_YL;
                    sumobj[24] += item.DTWC_FNJ3_YL;
                    sumobj[25] += item.CS_YL;
                    sumobj[26] += item.CS_JR;
                    sumobj[27] += item.OnlinePerson

                    html += innerhtm;
                });
                var sumhtm = "<tr><td>合计</td>";
                for (var item in sumobj) {
                    sumhtm += "<td>" + sumobj[item] + "</td>";
                    if (item>=27) {
                        break;
                    }
                }
                html += sumhtm+"</tr>";
                html += "</table>";
                $('.maitab').html(html);
            },
            error: function (d, b) {
                alert(d + b);
            }

        });
    }
    $(function () {
        GetData();
    });
</script>
<table id="hidhtm" style="display:none;">
    <thead>
        <tr class="list_tit">
            <td align="center" rowspan="4">
                项目
            </td>
            <td align="center" colspan="19">
                待录单量
            </td>
            <td align="center" colspan="6">
                当天录单完成量
            </td>
            <td align="center" colspan="2" rowspan="3">
                重扫量
            </td>
            <td align="center" rowspan="4">
                人数
            </td>
        </tr>
        <tr class="list_tit">
            @*待录量*@
            <td align="center" colspan="7">已下载单量</td>
            <td align="center" colspan="6">可下载单量</td>
            <td align="center" colspan="6">未预分配量</td>
            @*待录量*@

            @* 当天录单完成量*@
            <td align="center" colspan="2" rowspan="2">非南京一频</td>
            <td align="center" colspan="2" rowspan="2">非南京二频</td>
            <td align="center" colspan="2" rowspan="2">非南京三频</td>
            @* 当天录单完成量*@
        </tr>
        <tr class="list_tit">

            @* 已下载量*@
            <td align="center" colspan="2">非南京一频</td>
            <td align="center" colspan="2">非南京二频</td>
            <td align="center" colspan="2">非南京三频</td>
            <td align="center" rowspan="2">合计</td>
            @* 已下载量*@

            @* 已预分配量*@
            <td align="center" colspan="2">非南京一频</td>
            <td align="center" colspan="2">非南京二频</td>
            <td align="center" colspan="2">非南京三频</td>
            @* 已预分配量*@

            @* 未预分配量*@
            <td align="center" colspan="2">非南京一频</td>
            <td align="center" colspan="2">非南京二频</td>
            <td align="center" colspan="2">非南京三频</td>
            @* 未预分配量*@

        </tr>

        <tr>
            @* 已下载*@
            <td align="center">遗留</td>
            <td align="center">今日</td>
            <td align="center">遗留</td>
            <td align="center">今日</td>
            <td align="center">遗留</td>
            <td align="center">今日</td>
            @* 已下载*@

            @* 已预分配*@
            <td align="center">遗留</td>
            <td align="center">今日</td>
            <td align="center">遗留</td>
            <td align="center">今日</td>
            <td align="center">遗留</td>
            <td align="center">今日</td>
            @* 已预分配*@

            @* 未预分配*@ 
            <td align="center">遗留</td>
            <td align="center">今日</td>
            <td align="center">遗留</td>
            <td align="center">今日</td>
            <td align="center">遗留</td>
            <td align="center">今日</td>
            @* 未预分配*@

            @* 当天录单完成量*@
            <td align="center">遗留</td>
            <td align="center">今日</td>
            <td align="center">遗留</td>
            <td align="center">今日</td>
            <td align="center">遗留</td>
            <td align="center">今日</td>
            @* 当天录单完成量*@

            @* 提交邮政重扫量*@
            <td align="center">遗留</td>
            <td align="center">今日</td>
            @* 提交邮政重扫量*@
        </tr>
    </thead>
</table>
<div style=" text-align:right;height:30px; line-height:30px; font-size:14px; padding:0 15px;"><span>数据更新时间：</span><span id="timestr"></span></div>

<div class="maitab"></div>
